// Load the chat widget after the page is ready
$w.onReady(function () {
  // Inject required stylesheets
  const fontLink = document.createElement('link');
  fontLink.href = 'https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;600&display=swap';
  fontLink.rel = 'stylesheet';
  document.head.appendChild(fontLink);

  const chatStyle = document.createElement('link');
  chatStyle.href = 'https://cdn.jsdelivr.net/npm/@n8n/chat/dist/style.css';
  chatStyle.rel = 'stylesheet';
  document.head.appendChild(chatStyle);

  // Load the UMD version of the chat widget
  const script = document.createElement('script');
  script.src = 'https://cdn.jsdelivr.net/npm/@n8n/chat/dist/chat.bundle.umd.js';
  script.onload = () => {
    const createChat = window.n8nChat.createChat;

    createChat({
      webhookUrl: 'https://riverai67.app.n8n.cloud/webhook/24c8c7f0-c6b6-437a-8102-7ff7cd9b5e96/chat',
      mode: 'window',
      showWelcomeScreen: false,
      i18n: {
        en: {
          title: 'Chat with Us!',
          subtitle: "We're here to help.",
          inputPlaceholder: 'Type a message...'
        }
      }
    }).then(widget => {
      // Create a floating launcher button
      const button = document.createElement('div');
      button.innerText = 'ðŸ’¬';
      button.id = 'n8n-chat-launcher';
      button.style.cssText = `
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 10000;
        background-color: #007bff;
        color: white;
        padding: 12px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 24px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      `;
      document.body.appendChild(button);

      // Open the chat widget on click
      button.addEventListener('click', () => {
        widget.open();
      });
    });
  };
  document.body.appendChild(script);
});
